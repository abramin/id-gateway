<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Attack Lab - OAuth Security Education</title>
    <link rel="stylesheet" href="css/shared.css" />
    <link rel="stylesheet" href="css/index.css" />

    <!-- Alpine.js -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    <!-- Stores -->
    <script src="js/stores/theme-store.js"></script>
    <script src="js/stores/config-store.js"></script>

    <!-- Utils -->
    <script src="js/utils/formatting.js"></script>
  </head>
  <body x-data="indexPage">
    <!-- Navigation -->
    <nav class="nav">
      <div class="nav-brand">
        <span class="glow"> Attack Lab</span>
      </div>
      <div class="nav-links">
        <div class="theme-toggle">
          <button
            class="theme-toggle-btn"
            :class="{ 'active': $store.theme.isLight }"
            @click="$store.theme.setLight()"
            title="Light mode"
          >
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="5" />
              <path
                d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
              />
            </svg>
          </button>
          <button
            class="theme-toggle-btn"
            :class="{ 'active': $store.theme.isDark }"
            @click="$store.theme.setDark()"
            title="Dark mode"
          >
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
            </svg>
          </button>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
      <div class="hero-content">
        <p class="hero-eyebrow">Interactive Security Education</p>
        <h1 class="hero-title">Learn OAuth 2.0 Security</h1>
        <p class="hero-description">
          Explore common OAuth vulnerabilities in a safe, controlled
          environment. Understand how attacks work and learn to defend against
          them through hands-on interactive modules.
        </p>
        <pre
          class="ascii-art"
          role="img"
          aria-label="Credo Attack Lab ASCII art"
          translate="no"
        >
    _  _____ _____  _    ____ _  __  _       _    ____  
   / \|_   _|_   _|/ \  / ___| |/ / | |     / \  | __ ) 
  / _ \ | |   | | / _ \| |   | ' /  | |    / _ \ |  _ \ 
 / ___ \| |   | |/ ___ \ |___| . \  | |___/ ___ \| |_) |
/_/   \_\_|   |_/_/   \_\____|_|\_\ |_____/_/   \_\____/ 
        </pre>
        <div class="hero-stats">
          <div class="stat">
            <span class="stat-value">11</span>
            <span class="stat-label">Attack Types</span>
          </div>
          <div class="stat">
            <span class="stat-value">4</span>
            <span class="stat-label">Learning Modes</span>
          </div>
          <div class="stat">
            <span class="stat-value">15+</span>
            <span class="stat-label">Security Controls</span>
          </div>
        </div>
      </div>
      <div class="hero-visual">
        <div class="credo-logo-hero">
          <img src="images/logo.svg" alt="" role="presentation" aria-hidden="true" class="hero-logo-img" />
        </div>
      </div>
    </header>

    <!-- Module Cards -->
    <main class="container">
      <section class="modules-section">
        <h2 class="section-title">Choose Your Learning Path</h2>
        <p class="section-description">
          Each module offers a different approach to learning OAuth security.
          Pick the one that matches your learning style.
        </p>

        <div class="modules-grid">
          <!-- Control Panel Module -->
          <a href="control-panel.html" class="module-card">
            <div class="module-icon module-icon-control">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="3" y="3" width="7" height="7" rx="1" />
                <rect x="14" y="3" width="7" height="7" rx="1" />
                <rect x="3" y="14" width="7" height="7" rx="1" />
                <rect x="14" y="14" width="7" height="7" rx="1" />
              </svg>
            </div>
            <div class="module-content">
              <h3 class="module-title">Control Panel</h3>
              <p class="module-subtitle">Toggle-Based Defense Learning</p>
              <p class="module-description">
                Toggle security controls on and off to see which attacks succeed
                or fail. Visual feedback shows cause-and-effect relationships
                between configuration and security.
              </p>
              <div class="module-features">
                <span class="feature-tag">Interactive Toggles</span>
                <span class="feature-tag">Security Score</span>
                <span class="feature-tag">Instant Feedback</span>
              </div>
            </div>
            <div class="module-badge">
              <span class="badge badge-info">Beginner Friendly</span>
            </div>
          </a>

          <!-- Siren Scramble Module -->
          <a href="siren-scramble.html" class="module-card module-featured">
            <div class="module-icon module-icon-hacker">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M12 2l2 4 4 .5-3 3 .7 4.5L12 12l-3.7 2 1-4.5-3-3 4-.5z" />
              </svg>
            </div>
            <div class="module-content">
              <h3 class="module-title">Siren Scramble</h3>
              <p class="module-subtitle">Kid-Friendly Defense Drills</p>
              <p class="module-description">
                Quick alert reactions, silly decoys, and guided two-step combos to practice spotting and blocking pretend hacks.
              </p>
              <div class="module-features">
                <span class="feature-tag">Phishing clues</span>
                <span class="feature-tag">Strong passwords</span>
                <span class="feature-tag">Suspicious logins</span>
              </div>
            </div>
            <div class="module-badge">
              <span class="badge badge-warning">Kid Mode</span>
            </div>
          </a>

          <!-- Hacker Desktop Module (Featured) -->
          <a href="hacker-desktop.html" class="module-card module-featured">
            <div class="module-icon module-icon-hacker">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2" />
                <line x1="8" y1="21" x2="16" y2="21" />
                <line x1="12" y1="17" x2="12" y2="21" />
                <polyline points="7 10 10 13 7 16" />
                <line x1="13" y1="16" x2="17" y2="16" />
              </svg>
            </div>
            <div class="module-content">
              <h3 class="module-title">Hacker Desktop</h3>
              <p class="module-subtitle">Full Simulation Environment</p>
              <p class="module-description">
                A desktop-style environment with multiple windows: Flow Diagram
                to visualize attacks, Terminal to execute commands, and Request
                Inspector to analyze traffic. The ultimate hands-on hacking
                experience.
              </p>
              <div class="module-features">
                <span class="feature-tag">Flow Visualization</span>
                <span class="feature-tag">Hacker Terminal</span>
                <span class="feature-tag">Request Inspector</span>
              </div>
            </div>
            <div class="module-badge">
              <span class="badge badge-success">NEW</span>
            </div>
          </a>

          <!-- Dual Perspective Module -->
          <a href="dual-perspective.html" class="module-card">
            <div class="module-icon module-icon-story">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                <circle cx="9" cy="7" r="4" />
                <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
              </svg>
            </div>
            <div class="module-content">
              <h3 class="module-title">Dual Perspective</h3>
              <p class="module-subtitle">Story-Driven Scenario Learning</p>
              <p class="module-description">
                Experience attacks from both attacker and defender perspectives.
                Navigate through branching narratives with decision points and
                see how security configurations affect outcomes.
              </p>
              <div class="module-features">
                <span class="feature-tag">Narrative Mode</span>
                <span class="feature-tag">Decision Points</span>
                <span class="feature-tag">Both Perspectives</span>
              </div>
            </div>
            <div class="module-badge">
              <span class="badge badge-warning">Training Mode</span>
            </div>
          </a>

          <!-- Request Forge Module -->
          <a href="request-forge.html" class="module-card">
            <div class="module-icon module-icon-technical">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="16 18 22 12 16 6" />
                <polyline points="8 6 2 12 8 18" />
                <line x1="12" y1="2" x2="12" y2="22" stroke-dasharray="2 2" />
              </svg>
            </div>
            <div class="module-content">
              <h3 class="module-title">Request Forge</h3>
              <p class="module-subtitle">Technical Hands-On Sandbox</p>
              <p class="module-description">
                Build and send OAuth requests at the protocol level. Modify
                parameters, analyze responses, and decode JWTs with detailed
                security annotations. Compare secure vs insecure configurations
                side-by-side.
              </p>
              <div class="module-features">
                <span class="feature-tag">Request Builder</span>
                <span class="feature-tag">JWT Decoder</span>
                <span class="feature-tag">Compare Mode</span>
              </div>
            </div>
            <div class="module-badge">
              <span class="badge badge-success">Advanced</span>
            </div>
          </a>
        </div>
      </section>

      <!-- Attack Overview -->
      <section class="attacks-section">
        <h2 class="section-title">Attacks You'll Learn About</h2>
        <p class="section-description">
          These are the most common OAuth 2.0 vulnerabilities. Each module
          covers all of these attacks.
        </p>

        <div class="attacks-grid">
          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-warning">High</span>
              <span class="attack-category">Code Flow</span>
            </div>
            <h4 class="attack-title">Code Interception</h4>
            <p class="attack-description">
              Attacker intercepts authorization codes during redirect and
              exchanges them for tokens.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">PKCE</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-error">Critical</span>
              <span class="attack-category">Code Flow</span>
            </div>
            <h4 class="attack-title">Redirect URI Manipulation</h4>
            <p class="attack-description">
              Attacker modifies redirect_uri to steal authorization codes via
              phishing.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">Strict URI Validation</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-warning">High</span>
              <span class="attack-category">Token Security</span>
            </div>
            <h4 class="attack-title">Token Replay</h4>
            <p class="attack-description">
              Attacker replays tokens against services that don't validate
              audience claims.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">Audience Validation</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-warning">High</span>
              <span class="attack-category">Code Flow</span>
            </div>
            <h4 class="attack-title">CSRF on Callback</h4>
            <p class="attack-description">
              Attacker forces victim to complete OAuth flow with attacker's
              code.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">State Parameter</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-info">Medium</span>
              <span class="attack-category">Authorization</span>
            </div>
            <h4 class="attack-title">Scope Escalation</h4>
            <p class="attack-description">
              Attacker manipulates scope parameter to gain elevated permissions.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">Scope Validation</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-warning">High</span>
              <span class="attack-category">Token Security</span>
            </div>
            <h4 class="attack-title">Token Theft via XSS</h4>
            <p class="attack-description">
              Attacker exploits XSS to steal tokens from browser storage.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">HttpOnly Cookies</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-error">Critical</span>
              <span class="attack-category">Token Security</span>
            </div>
            <h4 class="attack-title">JWT Algorithm Confusion</h4>
            <p class="attack-description">
              Attacker forges tokens by switching signing algorithm from RS256
              to HS256.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">Algorithm Enforcement</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-warning">High</span>
              <span class="attack-category">Token Security</span>
            </div>
            <h4 class="attack-title">Refresh Token Hijacking</h4>
            <p class="attack-description">
              Attacker steals refresh token for persistent access that survives
              password changes.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">Token Rotation</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-info">Medium</span>
              <span class="attack-category">Code Flow</span>
            </div>
            <h4 class="attack-title">Open Redirect Phishing</h4>
            <p class="attack-description">
              Attacker uses OAuth endpoint as open redirector for convincing
              phishing URLs.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">Strict URI Validation</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-error">Critical</span>
              <span class="attack-category">Code Flow</span>
            </div>
            <h4 class="attack-title">AS Mix-Up Attack</h4>
            <p class="attack-description">
              Attacker steals codes in multi-IdP scenarios by confusing which AS
              issued them.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">Issuer Validation</span>
            </div>
          </div>

          <div class="attack-card">
            <div class="attack-header">
              <span class="badge badge-info">Medium</span>
              <span class="attack-category">Authorization</span>
            </div>
            <h4 class="attack-title">Clickjacking Authorization</h4>
            <p class="attack-description">
              Attacker tricks users into clicking hidden authorize button via
              iframe overlay.
            </p>
            <div class="attack-defense">
              <span class="defense-label">Blocked by:</span>
              <span class="defense-control">Frame Protection</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Quick Start -->
      <section class="quickstart-section">
        <div class="quickstart-content">
          <h2 class="section-title">Quick Start</h2>
          <p class="section-description">
            New to OAuth security? Start with the Control Panel for a visual
            introduction, then move to Dual Perspective for deeper
            understanding, and finally explore Request Forge for hands-on
            technical practice.
          </p>
          <a href="control-panel.html" class="btn btn-primary btn-lg">
            Start Learning
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M5 12h14M12 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <p class="footer-text">
        Part of the <strong>Credo</strong> identity verification platform. For
        educational purposes only.
      </p>
    </footer>

    <script>
      document.addEventListener("alpine:init", () => {
        Alpine.data("indexPage", () => ({
          // Page state if needed
        }));
      });
    </script>
  </body>
</html>
