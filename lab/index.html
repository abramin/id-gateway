<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Attack Lab - OAuth Security Education</title>
  <link rel="stylesheet" href="css/shared.css">
  <link rel="stylesheet" href="css/index.css">

  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <!-- Stores -->
  <script src="js/stores/theme-store.js"></script>
  <script src="js/stores/config-store.js"></script>

  <!-- Utils -->
  <script src="js/utils/formatting.js"></script>
</head>
<body x-data="indexPage">
  <!-- Navigation -->
  <nav class="nav">
    <div class="nav-brand">
      <svg class="brand-logo" viewBox="0 0 100 100" fill="none">
        <rect x="10" y="10" width="35" height="55" rx="3" stroke="currentColor" stroke-width="5" fill="none"/>
        <circle cx="27.5" cy="25" r="7" fill="currentColor"/>
        <line x1="27.5" y1="38" x2="27.5" y2="55" stroke="currentColor" stroke-width="5" stroke-linecap="round"/>
        <line x1="55" y1="12" x2="55" y2="65" stroke="currentColor" stroke-width="5" stroke-linecap="round"/>
        <line x1="70" y1="12" x2="70" y2="65" stroke="currentColor" stroke-width="5" stroke-linecap="round"/>
        <path d="M10 75 Q10 90 40 90 Q70 90 70 75" stroke="currentColor" stroke-width="5" fill="none" stroke-linecap="round"/>
      </svg>
      <span class="glow">Attack Lab</span>
    </div>
    <div class="nav-links">
      <div class="theme-toggle">
        <button
          class="theme-toggle-btn"
          :class="{ 'active': $store.theme.isLight }"
          @click="$store.theme.setLight()"
          title="Light mode"
        >
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
        </button>
        <button
          class="theme-toggle-btn"
          :class="{ 'active': $store.theme.isDark }"
          @click="$store.theme.setDark()"
          title="Dark mode"
        >
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <header class="hero">
    <div class="hero-content">
      <p class="hero-eyebrow">Interactive Security Education</p>
      <h1 class="hero-title">Learn OAuth 2.0 Security</h1>
      <p class="hero-description">
        Explore common OAuth vulnerabilities in a safe, controlled environment.
        Understand how attacks work and learn to defend against them through
        hands-on interactive modules.
      </p>
      <div class="hero-stats">
        <div class="stat">
          <span class="stat-value">6</span>
          <span class="stat-label">Attack Types</span>
        </div>
        <div class="stat">
          <span class="stat-value">3</span>
          <span class="stat-label">Learning Modes</span>
        </div>
        <div class="stat">
          <span class="stat-value">10+</span>
          <span class="stat-label">Security Controls</span>
        </div>
      </div>
    </div>
    <div class="hero-visual">
      <div class="credo-logo-hero">
        <svg viewBox="0 0 120 120" fill="none">
          <defs>
            <linearGradient id="credo-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#00ff41"/>
              <stop offset="100%" style="stop-color:#39ff14"/>
            </linearGradient>
            <filter id="glow">
              <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
              <feMerge>
                <feMergeNode in="coloredBlur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>
          <!-- Outer glow ring -->
          <circle cx="60" cy="60" r="55" stroke="url(#credo-gradient)" stroke-width="1" fill="none" opacity="0.2"/>
          <circle cx="60" cy="60" r="50" stroke="url(#credo-gradient)" stroke-width="1" fill="none" opacity="0.1"/>
          <!-- ID Card -->
          <rect x="20" y="20" width="45" height="65" rx="4" stroke="url(#credo-gradient)" stroke-width="3" fill="none" filter="url(#glow)"/>
          <rect x="20" y="20" width="45" height="65" rx="4" fill="url(#credo-gradient)" opacity="0.05"/>
          <!-- Person icon in card -->
          <circle cx="42.5" cy="38" r="8" fill="url(#credo-gradient)" opacity="0.8"/>
          <path d="M42.5 50 L42.5 70" stroke="url(#credo-gradient)" stroke-width="4" stroke-linecap="round" filter="url(#glow)"/>
          <!-- Vertical bars (barcode/data lines) -->
          <line x1="75" y1="22" x2="75" y2="78" stroke="url(#credo-gradient)" stroke-width="4" stroke-linecap="round" filter="url(#glow)"/>
          <line x1="88" y1="22" x2="88" y2="78" stroke="url(#credo-gradient)" stroke-width="4" stroke-linecap="round" filter="url(#glow)"/>
          <line x1="100" y1="30" x2="100" y2="70" stroke="url(#credo-gradient)" stroke-width="3" stroke-linecap="round" opacity="0.6"/>
          <!-- Curved connection at bottom -->
          <path d="M20 92 Q20 105 55 105 Q90 105 90 92" stroke="url(#credo-gradient)" stroke-width="3" fill="none" stroke-linecap="round" filter="url(#glow)"/>
          <!-- Data dots -->
          <circle cx="30" cy="75" r="2" fill="url(#credo-gradient)" opacity="0.6"/>
          <circle cx="38" cy="75" r="2" fill="url(#credo-gradient)" opacity="0.6"/>
          <circle cx="46" cy="75" r="2" fill="url(#credo-gradient)" opacity="0.6"/>
          <circle cx="54" cy="75" r="2" fill="url(#credo-gradient)" opacity="0.6"/>
        </svg>
      </div>
    </div>
  </header>

  <!-- Module Cards -->
  <main class="container">
    <section class="modules-section">
      <h2 class="section-title">Choose Your Learning Path</h2>
      <p class="section-description">
        Each module offers a different approach to learning OAuth security.
        Pick the one that matches your learning style.
      </p>

      <div class="modules-grid">
        <!-- Control Panel Module -->
        <a href="control-panel.html" class="module-card">
          <div class="module-icon module-icon-control">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7" rx="1"/>
              <rect x="14" y="3" width="7" height="7" rx="1"/>
              <rect x="3" y="14" width="7" height="7" rx="1"/>
              <rect x="14" y="14" width="7" height="7" rx="1"/>
            </svg>
          </div>
          <div class="module-content">
            <h3 class="module-title">Control Panel</h3>
            <p class="module-subtitle">Toggle-Based Defense Learning</p>
            <p class="module-description">
              Toggle security controls on and off to see which attacks succeed or fail.
              Visual feedback shows cause-and-effect relationships between configuration and security.
            </p>
            <div class="module-features">
              <span class="feature-tag">Interactive Toggles</span>
              <span class="feature-tag">Security Score</span>
              <span class="feature-tag">Instant Feedback</span>
            </div>
          </div>
          <div class="module-badge">
            <span class="badge badge-info">Beginner Friendly</span>
          </div>
        </a>

        <!-- Hacker Desktop Module (Featured) -->
        <a href="hacker-desktop.html" class="module-card module-featured">
          <div class="module-icon module-icon-hacker">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
              <line x1="8" y1="21" x2="16" y2="21"/>
              <line x1="12" y1="17" x2="12" y2="21"/>
              <polyline points="7 10 10 13 7 16"/>
              <line x1="13" y1="16" x2="17" y2="16"/>
            </svg>
          </div>
          <div class="module-content">
            <h3 class="module-title">Hacker Desktop</h3>
            <p class="module-subtitle">Full Simulation Environment</p>
            <p class="module-description">
              A desktop-style environment with multiple windows: Flow Diagram to visualize attacks,
              Terminal to execute commands, and Request Inspector to analyze traffic.
              The ultimate hands-on hacking experience.
            </p>
            <div class="module-features">
              <span class="feature-tag">Flow Visualization</span>
              <span class="feature-tag">Hacker Terminal</span>
              <span class="feature-tag">Request Inspector</span>
            </div>
          </div>
          <div class="module-badge">
            <span class="badge badge-success">NEW</span>
          </div>
        </a>

        <!-- Dual Perspective Module -->
        <a href="dual-perspective.html" class="module-card">
          <div class="module-icon module-icon-story">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
              <circle cx="9" cy="7" r="4"/>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
          </div>
          <div class="module-content">
            <h3 class="module-title">Dual Perspective</h3>
            <p class="module-subtitle">Story-Driven Scenario Learning</p>
            <p class="module-description">
              Experience attacks from both attacker and defender perspectives.
              Navigate through branching narratives with decision points and see how
              security configurations affect outcomes.
            </p>
            <div class="module-features">
              <span class="feature-tag">Narrative Mode</span>
              <span class="feature-tag">Decision Points</span>
              <span class="feature-tag">Both Perspectives</span>
            </div>
          </div>
          <div class="module-badge">
            <span class="badge badge-warning">Training Mode</span>
          </div>
        </a>

        <!-- Request Forge Module -->
        <a href="request-forge.html" class="module-card">
          <div class="module-icon module-icon-technical">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="16 18 22 12 16 6"/>
              <polyline points="8 6 2 12 8 18"/>
              <line x1="12" y1="2" x2="12" y2="22" stroke-dasharray="2 2"/>
            </svg>
          </div>
          <div class="module-content">
            <h3 class="module-title">Request Forge</h3>
            <p class="module-subtitle">Technical Hands-On Sandbox</p>
            <p class="module-description">
              Build and send OAuth requests at the protocol level. Modify parameters,
              analyze responses, and decode JWTs with detailed security annotations.
              Compare secure vs insecure configurations side-by-side.
            </p>
            <div class="module-features">
              <span class="feature-tag">Request Builder</span>
              <span class="feature-tag">JWT Decoder</span>
              <span class="feature-tag">Compare Mode</span>
            </div>
          </div>
          <div class="module-badge">
            <span class="badge badge-success">Advanced</span>
          </div>
        </a>
      </div>
    </section>

    <!-- Attack Overview -->
    <section class="attacks-section">
      <h2 class="section-title">Attacks You'll Learn About</h2>
      <p class="section-description">
        These are the most common OAuth 2.0 vulnerabilities. Each module covers all of these attacks.
      </p>

      <div class="attacks-grid">
        <div class="attack-card">
          <div class="attack-header">
            <span class="badge badge-warning">High</span>
            <span class="attack-category">Code Flow</span>
          </div>
          <h4 class="attack-title">Code Interception</h4>
          <p class="attack-description">
            Attacker intercepts authorization codes during redirect and exchanges them for tokens.
          </p>
          <div class="attack-defense">
            <span class="defense-label">Blocked by:</span>
            <span class="defense-control">PKCE</span>
          </div>
        </div>

        <div class="attack-card">
          <div class="attack-header">
            <span class="badge badge-error">Critical</span>
            <span class="attack-category">Code Flow</span>
          </div>
          <h4 class="attack-title">Redirect URI Manipulation</h4>
          <p class="attack-description">
            Attacker modifies redirect_uri to steal authorization codes via phishing.
          </p>
          <div class="attack-defense">
            <span class="defense-label">Blocked by:</span>
            <span class="defense-control">Strict URI Validation</span>
          </div>
        </div>

        <div class="attack-card">
          <div class="attack-header">
            <span class="badge badge-warning">High</span>
            <span class="attack-category">Token Security</span>
          </div>
          <h4 class="attack-title">Token Replay</h4>
          <p class="attack-description">
            Attacker replays tokens against services that don't validate audience claims.
          </p>
          <div class="attack-defense">
            <span class="defense-label">Blocked by:</span>
            <span class="defense-control">Audience Validation</span>
          </div>
        </div>

        <div class="attack-card">
          <div class="attack-header">
            <span class="badge badge-warning">High</span>
            <span class="attack-category">Code Flow</span>
          </div>
          <h4 class="attack-title">CSRF on Callback</h4>
          <p class="attack-description">
            Attacker forces victim to complete OAuth flow with attacker's code.
          </p>
          <div class="attack-defense">
            <span class="defense-label">Blocked by:</span>
            <span class="defense-control">State Parameter</span>
          </div>
        </div>

        <div class="attack-card">
          <div class="attack-header">
            <span class="badge badge-info">Medium</span>
            <span class="attack-category">Authorization</span>
          </div>
          <h4 class="attack-title">Scope Escalation</h4>
          <p class="attack-description">
            Attacker manipulates scope parameter to gain elevated permissions.
          </p>
          <div class="attack-defense">
            <span class="defense-label">Blocked by:</span>
            <span class="defense-control">Scope Validation</span>
          </div>
        </div>

        <div class="attack-card">
          <div class="attack-header">
            <span class="badge badge-warning">High</span>
            <span class="attack-category">Token Security</span>
          </div>
          <h4 class="attack-title">Token Theft via XSS</h4>
          <p class="attack-description">
            Attacker exploits XSS to steal tokens from browser storage.
          </p>
          <div class="attack-defense">
            <span class="defense-label">Blocked by:</span>
            <span class="defense-control">HttpOnly Cookies</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Quick Start -->
    <section class="quickstart-section">
      <div class="quickstart-content">
        <h2 class="section-title">Quick Start</h2>
        <p class="section-description">
          New to OAuth security? Start with the Control Panel for a visual introduction,
          then move to Dual Perspective for deeper understanding, and finally
          explore Request Forge for hands-on technical practice.
        </p>
        <a href="control-panel.html" class="btn btn-primary btn-lg">
          Start Learning
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </a>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p class="footer-text">
      Part of the <strong>Credo</strong> identity verification platform.
      For educational purposes only.
    </p>
  </footer>

  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.data('indexPage', () => ({
        // Page state if needed
      }));
    });
  </script>
</body>
</html>
